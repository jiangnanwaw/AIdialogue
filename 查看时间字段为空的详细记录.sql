-- 查看充电结束时间为NULL但充电电量不为NULL的详细记录
-- 用于分析为什么两个查询结果不一样

-- 方式1：列出所有字段的详细记录
SELECT 
    [订单编号],
    [电站名称],
    [终端名称],
    [充电电量(度)],
    [充电结束时间],
    [充电开始时间],
    [充电服务费(元)],
    [充电费用(元)],
    [充电时长(分钟)],
    [判定车牌号]
FROM [特来电]
WHERE [电站名称] IN ('华为飞狐特来电高岭超充站','长沙市开福区高岭香江国际城充电站建设项目')
    AND [充电结束时间] IS NULL
    AND [充电电量(度)] IS NOT NULL
ORDER BY [电站名称], [终端名称], [充电电量(度)] DESC;

-- 方式2：只列出关键字段（如果记录太多，可以使用这个）
-- SELECT 
--     [电站名称],
--     [终端名称],
--     [充电电量(度)],
--     [充电结束时间],
--     [充电开始时间],
--     [订单编号]
-- FROM [特来电]
-- WHERE [电站名称] IN ('华为飞狐特来电高岭超充站','长沙市开福区高岭香江国际城充电站建设项目')
--     AND [充电结束时间] IS NULL
--     AND [充电电量(度)] IS NOT NULL
-- ORDER BY [电站名称], [充电电量(度)] DESC;

-- 方式3：按电站和终端分组统计（汇总视图）
-- SELECT 
--     [电站名称],
--     [终端名称],
--     COUNT(*) AS 记录数,
--     SUM([充电电量(度)]) AS 总充电电量,
--     AVG([充电电量(度)]) AS 平均充电电量,
--     MIN([充电电量(度)]) AS 最小充电电量,
--     MAX([充电电量(度)]) AS 最大充电电量
-- FROM [特来电]
-- WHERE [电站名称] IN ('华为飞狐特来电高岭超充站','长沙市开福区高岭香江国际城充电站建设项目')
--     AND [充电结束时间] IS NULL
--     AND [充电电量(度)] IS NOT NULL
-- GROUP BY [电站名称], [终端名称]
-- ORDER BY [电站名称], 总充电电量 DESC;

-- 方式4：统计总数和总电量（快速查看影响）
-- SELECT 
--     COUNT(*) AS 时间字段为空的记录数,
--     SUM([充电电量(度)]) AS 这些记录的总充电电量,
--     AVG([充电电量(度)]) AS 平均每条记录的充电电量
-- FROM [特来电]
-- WHERE [电站名称] IN ('华为飞狐特来电高岭超充站','长沙市开福区高岭香江国际城充电站建设项目')
--     AND [充电结束时间] IS NULL
--     AND [充电电量(度)] IS NOT NULL;


